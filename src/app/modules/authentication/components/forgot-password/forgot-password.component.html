<div class="forgot-password-wrapper">
    <div fxLayout="column" fxFlex fxLayoutAlign="center center">
        <div class="login-title">
            <mat-label>Forgot Credentials?</mat-label>
        </div>
        <div class="login-form" *ngIf="!isRequestPassword">
            <form
                class="body-card-login-form"
                [formGroup]="forgotPasswordForm"
                (ngSubmit)="onRequestPasswordClick()"
                novalidate="novalidate"
                fxLayout="column"
                autocomplete="off"
            >
                <mat-form-field class="md-block">
                    <mat-label>User Id</mat-label>
                    <input matInput formControlName="userName" type="text" name="userName" />
                    <i matSuffix class="las la-user-tie"></i>
                </mat-form-field>
                <div
                    fxFlex="100"
                    fxLayout="row"
                    fxLayoutGap="10"
                    fxLayout.sm="column"
                    fxLayout.xs="column"
                    class="login-btn"
                >
                    <button mat-flat-button (click)="onCancelClick()" type="button">CANCEL</button>
                    <button mat-flat-button color="primary" [disabled]="!forgotPasswordForm.valid" type="submit">
                        REQUEST PASSWORD
                    </button>
                </div>
            </form>
        </div>
        <div class="login-form" *ngIf="isRequestPassword">
            <form
                class="body-card-login-form"
                [formGroup]="userRIMSelectionForm"
                (ngSubmit)="onForgotPasswordConfirm()"
                autocomplete="off"
                fxLayout="column"
            >
                <mat-form-field class="md-block">
                    <mat-label>New Password</mat-label>
                    <input
                        #newPassword
                        formControlName="newPasswrd"
                        matInput
                        aria-label="Password"
                        required
                        type="password"
                        maxlength="64"
                        autocomplete="off"
                        autofill="off"
                        pattern="^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$"
                        #tooltip="matTooltip"
                        [matTooltipPosition]="'right'"
                        matTooltip="Password should contain minimun 8 and maximum 20 alphanumeric characters with atleast 1 special character e.g.(!@#$%^&*)"
                    />
                    <i matSuffix class="las la-unlock-alt"></i>
                </mat-form-field>
                <mat-form-field class="md-block">
                    <mat-label>Confirm Password</mat-label>
                    <input
                        #confirmPassword
                        formControlName="confirmPasswrd"
                        matInput
                        aria-label="Password"
                        required
                        type="password"
                        maxlength="64"
                        autocomplete="off"
                        autofill="off"
                        pattern="^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$"
                        #tooltip="matTooltip"
                        [matTooltipPosition]="'right'"
                        matTooltip="Both passwords should match"
                    />
                    <i matSuffix class="las la-unlock-alt"></i>
                </mat-form-field>
                <div class="password-mismatch" *ngIf="newPassword.value !== confirmPassword.value">
                    Password mismatch
                </div>
                <app-cib-otp (otpValueEvent)="otp = $event" [username]="username"></app-cib-otp>
                <div
                    fxFlex="100"
                    fxLayout="row"
                    fxLayoutGap="10px"
                    fxLayout.sm="column"
                    fxLayout.xs="column"
                    class="login-btn"
                >
                    <button
                        mat-flat-button
                        type="button"
                        aria-label="Cancel OTP"
                        (click)="onCancelClick()"
                        fxFlex="50"
                        fxLayout.md="100"
                    >
                        CANCEL
                    </button>
                    <button
                        mat-flat-button
                        color="primary"
                        [disabled]="
                            !userRIMSelectionForm.valid ||
                            !(otp && otp.length >= 6) ||
                            userRIMSelectionForm.get('newPasswrd')?.value !==
                                userRIMSelectionForm.get('confirmPasswrd')?.value
                        "
                        aria-label="Confirm OTP"
                        type="submit"
                        fxFlex="50"
                        fxLayout.md="100"
                    >
                        CONFIRM
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
