<app-master-container *ngIf="!successData">
    <ng-container header>DHAREEBA BILL PAYMENT</ng-container>
    <ng-container icons> </ng-container>
    <ng-container body>
        <div fxFlex="100">
            <form [formGroup]="form" fxLayout="column" autocomplete="off" novalidate="novalidate">
                <div fxLayout="row" fxLayoutGap="2rem" fxLayoutAlign="start center">
                    <mat-form-field fxFlex="45">
                        <mat-label>Tin Number</mat-label>
                        <input
                            type="text"
                            aria-label="qatarId"
                            matInput
                            value="tinNumber"
                            [value]="selectedTin"
                            disabled
                        />
                    </mat-form-field>
                    <mat-form-field fxFlex="45">
                        <mat-label>Select Bill Number</mat-label>
                        <mat-select formControlName="bill">
                            <mat-option
                                (onSelectionChange)="onBillSelected($event, bill)"
                                *ngFor="let bill of billList; let i = index"
                                [value]="bill"
                            >
                                {{ bill.itemCode }}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div fxLayout="row" fxLayoutAlign="space-between">
                    <mat-form-field fxFlex="30">
                        <mat-label>Tax Amount</mat-label>
                        <input matInput type="text" [value]="selectedBill.itemPrice" disabled />
                    </mat-form-field>

                    <mat-form-field fxFlex="30">
                        <mat-label>Currency</mat-label>
                        <input matInput type="text" [value]="selectedBill.itemCurrencyCode" disabled />
                    </mat-form-field>

                    <mat-form-field fxFlex="30">
                        <mat-label>Due Date</mat-label>
                        <input
                            matInput
                            type="text"
                            [value]="selectedBill.itemDueDate && selectedBill.itemDueDate.split(' ')[0]"
                            disabled
                        />
                    </mat-form-field>
                </div>

                <ng-container *appHasEntitlementAccessTo="'PAYMENT_PAY_DHAREEBA_BILL'">
                    <app-from-account
                        [parentForm]="form"
                        [fromAccounts]="accountList"
                        (selectAccount)="selectFromAccount($event)"
                    ></app-from-account>

                    <div fxLayout="row">
                        <button
                            mat-button
                            [disabled]="form.invalid"
                            class="mat-raised-button mat-primary"
                            aria-label="Submit"
                            (click)="onPayBill(DECISION.VERIFY)"
                        >
                            PAY NOW
                        </button>
                    </div>
                </ng-container>
            </form>
        </div>
    </ng-container>
</app-master-container>

<div *ngIf="successData">
    <app-cib-notification [headerTitle]="'DHAREEBA BILL PAYMENT STATUS'" [title]="title" [variant]="'success'">
        <ng-container body>
            <div class="success-info">
                <app-label-value [label]="'Tin Number'" [value]="successData?.tinNumber"></app-label-value>
                <app-label-value [label]="'Bill Number'" [value]="successData?.billNumber"></app-label-value>
                <app-label-value [label]="'Bill Amount'" [value]="successData?.selectedItems.paidAmount">
                </app-label-value>
                <app-label-value [label]="'Currency'" [value]="successData?.currency"></app-label-value>
                <app-label-value [label]="'Due Date'" [value]="successData.dueDate.split(' ')[0]"></app-label-value>
                <app-label-value [label]="'Account Number'" [value]="successData?.debitAccountId"></app-label-value>
            </div>
        </ng-container>
    </app-cib-notification>
</div>
